<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ollama Chat</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="layout">
    
    <aside class="sidebar left">      
      <!-- Left sidebar content -->
      {% if session.username %}
        <p>Welcome, {{ session.username }}! 
          <a href="{{ url_for('change_password') }}">Change Password</a> | 
          <a href="{{ url_for('logout') }}">Logout</a>
        </p>
      {% else %}
        <p><a href="{{ url_for('login') }}">Login</a></p>
      {% endif %}
      <button onclick="window.location.href='/new_chat'">New Chat</button><br><br>
      <button onclick="window.location.href='/export_markdown'">Export Markdown</button>
    </aside>
    
    <main class="content">
      <!-- Main chat/content goes here -->
      <h1>Chat with Ollama (LLaMA 3)</h1>

      <div class="chat-box">
          {% for entry in chat_history %}
              <div class="message {{ entry.role }}" >
                  <strong>{{ entry.role.capitalize() }}:</strong><br>
                  {{ entry.content | safe }}
                  {% if entry.role == 'assistant' %}
                    <button class="copy-raw-btn" data-raw="{{ entry.raw | e }}">Copy raw markdown</button>
                  {% endif %}
              </div>
          {% endfor %}
      </div>

      {% if error %}
          <div style="color:red;">⚠️ {{ error }}</div>
      {% endif %}

      <form method="POST" id="chat-form">
          <textarea name="prompt" id="prompt" rows="2" required placeholder="Type your message..."></textarea>
          <button type="submit">Send</button>
      </form>

    </main>
    
    <aside class="sidebar right">
      <!-- Right sidebar content -->
      <!-- empty for now -->
    </aside>
    
  </div>

    <div class="container">
        
    </div>

    <script src="{{ url_for('static', filename='main.js') }}" defer></script>

</body>
</html>

